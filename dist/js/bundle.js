(function(window,document,$){window.DomOutline={};var DomOutline=function(options){"use strict";options=options||{};var pub={},self={opts:{namespace:options.namespace||"DomOutline",onClick:options.onClick||false,realtime:options.realtime||false,$elem:options.elem||jQuery("body")},keyCodes:{BACKSPACE:8,ESC:27,DELETE:46},active:false,initialized:false,elements:{}};function writeStylesheet(css){var element=document.createElement("style");element.type="text/css";if(self.opts.$elem){self.opts.$elem.append(element)}else{document.getElementsByTagName("head")[0].appendChild(element)}if(element.styleSheet){element.styleSheet.cssText=css}else{element.innerHTML=css}}function initStylesheet(){var css="";if(self.initialized!==true){css+="."+self.opts.namespace+" {"+"    background: rgba(0, 153, 204, 0.05);"+"    position: fixed;"+"    z-index: 1000000;"+"    pointer-events: none;"+"    outline: 3px solid rgb(0, 153, 204);"+"}"+"."+self.opts.namespace+"_label {"+"    background: #09c;"+"    boroutlineder-radius: 2px;"+"    color: #fff;"+"    font: bold 12px/12px Helvetica, sans-serif;"+"    padding: 4px 6px;"+"    position: fixed;"+"    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);"+"    z-index: 1000001;"+"    pointer-events: none;"+"}"+"."+self.opts.namespace+"_box {"+"    background: rgba(0, 153, 204, 0.05);"+"    position: absolute;"+"    z-index: 1000000;"+"    pointer-events: none;"+"    outline: 3px solid rgb(0, 153, 204);"+"    box-shadow: 6px 6px 2px rgba(0, 0, 0, 0.2);"+"}";writeStylesheet(css);self.initialized=true}}function createOutlineElements(){self.elements.top=jQuery("<div>").addClass(self.opts.namespace).insertAfter(self.opts.$elem);self.elements.bottom=jQuery("<div>").addClass(self.opts.namespace).insertAfter(self.opts.$elem);self.elements.left=jQuery("<div>").addClass(self.opts.namespace).insertAfter(self.opts.$elem);self.elements.right=jQuery("<div>").addClass(self.opts.namespace).insertAfter(self.opts.$elem);self.elements.box=jQuery("<div>").addClass(self.opts.namespace+"_box").insertAfter(self.opts.$elem)}function removeOutlineElements(){jQuery.each(self.elements,function(name,element){element.remove()})}function getScrollTop(){if(!self.elements.window){self.elements.window=jQuery(window)}return self.elements.window.scrollTop()}function stopOnEscape(e){if(e.keyCode===self.keyCodes.ESC||e.keyCode===self.keyCodes.BACKSPACE||e.keyCode===self.keyCodes.DELETE){pub.stop()}return false}function draw(e){if(e.target.className.indexOf(self.opts.namespace)!==-1){return}pub.element=e.target;var scroll_top=getScrollTop(),pos=pub.element.getBoundingClientRect(),top=pos.top+scroll_top,label_text="",label_top=0,label_left=0;self.elements.box.css({top:self.opts.$elem.scrollTop()+pos.top-1,left:pos.left-1,width:pos.width+2,height:pos.height+2})}function clickHandler(e){if(!self.opts.realtime){draw(e)}self.opts.onClick(pub.element);return false}pub.start=function(){removeOutlineElements();initStylesheet();if(self.active!==true){self.active=true;createOutlineElements();self.opts.$elem.bind("keyup."+self.opts.namespace,stopOnEscape);if(self.opts.onClick){setTimeout(function(){self.opts.$elem.bind("click."+self.opts.namespace,clickHandler)},50)}if(self.opts.realtime){self.opts.$elem.bind("mousemove."+self.opts.namespace,draw)}}};pub.stop=function(){self.active=false;removeOutlineElements();self.opts.$elem.unbind("mousemove."+self.opts.namespace).unbind("keyup."+self.opts.namespace).unbind("click."+self.opts.namespace)};pub.pause=function(){self.active=false;self.opts.$elem.unbind("mousemove."+self.opts.namespace).unbind("keyup."+self.opts.namespace).unbind("click."+self.opts.namespace)};return pub};window.DomOutline=DomOutline})(window,document,$);(function(window,document,$){"use strict";var LiveEditorModal=function LiveEditorModal(params){this.init(params)};LiveEditorModal.prototype.init=function(params){this.editor=params.editor;this.name=params.data.name;this.title=params.data.title;this.field=params.data.field;this.create()};LiveEditorModal.prototype.create=function(){var $modal=$('<div class="modal fade" tabindex="-1" role="dialog">'),$div2=$('<div class="modal-dialog" role="document">'),$div3=$('<div class="modal-content">'),$header='<div class="modal-header">'+'<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>'+'<h4 class="modal-title">'+this.title+"</h4>"+"</div>",$field=$("<"+this.field+' class="form-control">'),$section='<div class="modal-body">'+$field[0].outerHTML+"</div>",$footer='<div class="modal-footer">'+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>'+'<button type="submit" class="btn btn-primary save-btn">Save</button>'+"</div>";$modal.attr("id",this.name);$modal.append($div2.append($div3.append($header,$section,$footer)));$("body").append($modal)};window.LiveEditorModal=LiveEditorModal})(window,document,$);(function(window,document,$){"use strict";var LiveEditorCodePanel=function LiveEditorCodePanel(params){this.init(params)};LiveEditorCodePanel.prototype.init=function(params){this.editorName=params.editorName;this.appendTo=params.appendTo||null;this.create()};LiveEditorCodePanel.prototype.create=function(){var $button=$('<button class="btn btn-primary btn-sm code-panel-button" type="button" data-toggle="collapse" data-target="#code-panel['+this.editorName+']" '+this.editorName+'="1">').text("< edit code >"),$panel=$('<div id="code-panel" class="code-panel collapse" '+this.editorName+'="1">'),html='<div class="well">'+'<div class="row">'+'<div class="col-xs-10">'+'<textarea class="form-control" rows="10"></textarea>'+"</div>"+'<div class="code-panel-buttons">'+'<button class="btn btn-default" type="button" data-toggle="collapse" data-target="#code-panel['+this.editorName+']">cancel</button>'+'<button class="btn btn-danger" type="button" data-toggle="collapse" data-target="#code-panel['+this.editorName+']">save code</button>'+"</div>"+"</div>"+"</div>";$panel.append(html);if(this.appendTo){this.appendTo.append($button,$panel)}else{$("body").append($button,$panel)}};window.LiveEditorCodePanel=LiveEditorCodePanel})(window,document,$);(function(window,document,$){"use strict";var FloatingMenu=function FloatingMenu(params){this.init(params)};FloatingMenu.prototype.init=function(params){this.LEFT_GAP=10;this.TOP_GAP=-10;this.$menu=$('<ul class="dropdown-menu" role="menu">');this.elemId=params.elemId;$("body").append(this.$menu);this.create(params.data);this.bindEvents()};FloatingMenu.prototype.create=function(params){var value=params.value||"(element)",posTop=params.posTop||0,posLeft=params.posLeft||0,menuHtml=this.newItem({value:value,is_header:true}),editList=[{value:"Edit HTML",attrs:{"data-operation":"edit-html","data-toggle":"modal","data-target":"#edit-html-modal-"+this.elemId}},{value:"Edit Text",attrs:{"data-operation":"edit-text","data-toggle":"modal","data-target":"#edit-text-modal-"+this.elemId}},{value:"Edit Classes",attrs:{"data-operation":"edit-classes","data-toggle":"modal","data-target":"#edit-classes-modal-"+this.elemId}},{value:"Edit Style",attrs:{"data-operation":"edit-style"}}],events=[{value:"Click",attrs:{"data-operation":"add-event-click"}}];menuHtml+=this.newItem({value:"Edit Element",items:editList});menuHtml+=this.newItem({attrs:{"class":"divider"}});menuHtml+=this.newItem({value:"Move and Resize",attrs:{"data-operation":"move-and-resize"}});menuHtml+=this.newItem({value:"Remove",attrs:{"data-operation":"remove"}});menuHtml+=this.newItem({attrs:{"class":"divider"}});menuHtml+=this.newItem({value:"Select Container",items:params.container});menuHtml+=this.newItem({attrs:{"class":"divider"}});menuHtml+=this.newItem({value:"Create new goal",items:events});this.$menu.append(menuHtml);this.$menu.css({top:this.defineTop(posTop,this.$menu.height()),left:this.defineLeft(posLeft,this.$menu.width())})};FloatingMenu.prototype.bindEvents=function(){var self=this;this.$menu.on("click","li",function(e){var op=$(this).data("operation");if(op){var _event=new CustomEvent("floatingMenuItemClicked",{detail:{operation:op,liveEditor:self.elemId}});document.dispatchEvent(_event);console.log("Operation: "+op)}})};FloatingMenu.prototype.open=function(){this.$menu.show()};FloatingMenu.prototype.close=function(){this.$menu.remove()};FloatingMenu.prototype.newItem=function(params){var $li=$("<li>");if(params.attrs){$li.attr(params.attrs)}if(params.is_header){$li.addClass("dropdown-header").text("<"+params.value+">")}else if(params.value){$li.append('<a tabindex="-1" href="#">'+params.value+"</a>")}if(params.items){var $subMenu=$('<ul class="dropdown-menu">');for(var i=0;i<=params.items.length-1;i++){var $_li=$('<li class="container-item-el">');$_li.attr(params.items[i].attrs).append('<a tabindex="-1" href="#">'+params.items[i].value+"</a>");$subMenu.append($_li)}$li.addClass("dropdown-submenu");$li.append($subMenu)}return $li.prop("outerHTML")};FloatingMenu.prototype.defineLeft=function(leftData,menu_width){if(leftData===0){return 0}var next_location=leftData.iframe_left+leftData.box_offset_left+leftData.box_width+this.LEFT_GAP;if(next_location+menu_width>=leftData.iframe_width){next_location=leftData.iframe_left+leftData.box_offset_left-menu_width-this.LEFT_GAP}return next_location};FloatingMenu.prototype.defineTop=function(topData,menu_height){if(topData===0){return 0}console.log(topData);var next_location=topData.iframe_top+topData.box_offset_top-topData.scroll_top+this.TOP_GAP;if(next_location+menu_height>=topData.iframe_height){next_location=topData.iframe_top+topData.box_offset_top-topData.scroll_top+topData.box_heigh-menu_height+this.TOP_GAP}console.log(next_location);return next_location};window.FloatingMenu=FloatingMenu})(window,document,$);(function(window,document,$){"use strict";var LiveEditor=function LiveEditor(params){console.log("Live Editor Init...");this.init(params);console.log("Live Editor Done...")};LiveEditor.prototype.init=function(params){var self=this;this.liveEditors=[];this.getUrlContent(params)};LiveEditor.prototype.getUrlContent=function(params){var self=this;$.get(params.url,function(data){self.content=data;self.initLiveEditors(params)})};LiveEditor.prototype.initLiveEditors=function(params){for(var i=0;i<=params.editors.length-1;i++){this.liveEditors.push(new LiveEditorBase({editor:params.editors[i],content:this.content}))}};window.LiveEditor=LiveEditor})(window,document,$);